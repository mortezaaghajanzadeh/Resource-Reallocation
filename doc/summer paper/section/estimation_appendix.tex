I will follow the the \cite{kmenta1967estimation},\cite{blundell2000gmm},\cite{davis2014macroeconomic} to estimate the parameters of the model. The production function is:
\begin{gather*}
    Y_{it} = \hat{A}_{it}(
        \alpha G_{it}^{\frac{\gamma-1}{\gamma}} + (1-\alpha) B_{it}^{\frac{\gamma-1}{\gamma}}
    ) ^ {\frac{\beta\gamma}{\gamma-1}} L_{it}^{1-\beta}\\
    \ln Y_{it} = \ln \hat{A}_{it} + \frac{\beta\gamma}{\gamma-1} \ln(
        \alpha G_{it}^{\frac{\gamma-1}{\gamma}} + (1-\alpha) B_{it}^{\frac{\gamma-1}{\gamma}}
    ) + (1-\beta) \ln L_{it}
\end{gather*}
as I cannot measure the production directly, I will use the total revenue in the place of the production. So, the equation becomes:
\begin{gather*}
    \ln \nu_{t}(P_{it}Y_{it})^{\frac{\sigma}{\sigma - 1}} = \ln \hat{A}_{it} + \frac{\beta\gamma}{\gamma-1} \ln(
        \alpha G_{it}^{\frac{\gamma-1}{\gamma}} + (1-\alpha) B_{it}^{\frac{\gamma-1}{\gamma}}
    ) + (1-\beta) \ln L_{it}\\
    \ln P_{it}Y_{it} = \frac{\sigma - 1}{\sigma}({\ln \hat{A}_{it} + \frac{\beta\gamma}{\gamma-1} \ln(
        \alpha G_{it}^{\frac{\gamma-1}{\gamma}} + (1-\alpha) B_{it}^{\frac{\gamma-1}{\gamma}}
    ) + (1-\beta) \ln L_{it}}) - \ln \nu_{s}
\end{gather*}
where $\nu_{s}$ is the price of the output of the sector $s$.

I take the first-order approximation of the production function around the $\gamma_s = 1$. This requires to take the limit of the third term in the production function as $\gamma_s$ approaches 1. The limit is:
\begin{gather*}
    \lim_{\gamma_s \to 1} \frac{\gamma}{\gamma-1} \ln(
        \alpha G_{it}^{\frac{\gamma-1}{\gamma}} + (1-\alpha) B_{it}^{\frac{\gamma-1}{\gamma}}
    ) = \alpha \ln G_{it}   + (1-\alpha)\ln B_{it}
\end{gather*}
and the limit of the derivative of this same term
\begin{gather*}
    \lim_{\gamma_s \to 1} \frac{\partial}{\partial \gamma_s} \left( \frac{\gamma}{\gamma-1} \ln(
        \alpha G_{it}^{\frac{\gamma-1}{\gamma}} + (1-\alpha) B_{it}^{\frac{\gamma-1}{\gamma}}
    ) \right) =  \frac{\alpha (1-\alpha)}{2}(\ln G_{it} - \ln B_{it})^2
\end{gather*}
The first-order approximation of the production function is:
\begin{equation*}
     \begin{split}
        \ln P_{it}Y_{it} \sim  & \frac{\sigma}{\sigma-1}(\ln \hat{A}_{it}) +  \frac{\sigma}{\sigma-1}\beta\alpha \ln G_{it}   + \frac{\sigma}{\sigma-1}\beta(1-\alpha)\ln B_{it} + \frac{\sigma}{\sigma-1}(1-\beta) \ln L_{it} \\
         & + \frac{\sigma}{\sigma-1}\beta \frac{\alpha (1-\alpha)(\gamma_s - 1)}{2}(\ln G_{it} - \ln B_{it})^2 - \ln \nu_{t}
    \end{split}
\end{equation*}

\begin{itemize}
    \item IV:\\
    \item Firm level:\\
    I assume that the $\hat{A}_{it} \equiv e^a e^{u_{it}}$, where $a$ is the common component of productivity and $u_{it}$ is the unpredictable component. We can rewrite the production function as:
    \begin{equation*}
        \begin{split}
           \ln P_{it}Y_{it} \sim  & \frac{\sigma}{\sigma-1}(a + u_{it}) +  \frac{\sigma}{\sigma-1}\beta\alpha \ln G_{it}   + \frac{\sigma}{\sigma-1}\beta(1-\alpha)\ln B_{it} + \frac{\sigma}{\sigma-1}(1-\beta) \ln L_{it} \\
            & + \frac{\sigma}{\sigma-1}\beta \frac{\alpha (1-\alpha)(\gamma_s - 1)}{2}(\ln G_{it} - \ln B_{it})^2 - \ln \nu_{t}
       \end{split}
    \end{equation*}
    
    To estimate this approximation, I assume that the error term can be decomposed as $u_{it} = f_i + \epsilon_{it}$ where $f_i$ varies across firm. Then I can use OLS with firm fixed effects  within each Industry and appropriately defined coefficients:
    \begin{gather*}
        \ln P_{it}Y_{it} = \beta_0^Y + \beta_G^Y \ln G_{it} + \beta_B^Y \ln B_{it} + \beta_L^Y \ln L_{it} + \beta_{GB}^Y (\ln G_{it} - \ln B_{it})^2 + \mu_i + \mu_t + \epsilon_{it}
    \end{gather*}
    
    The industry effects will be absorbed by the constant term as the estimation is done within each industry.  
    
    \item AR(1):\\
    Alternatively, I can assume that the error term is $u_{it} = z_{it} + \epsilon_{it}$ where $z_{it}$ is a predictable component that follows the AR(1) process $z_{it} = \rho z_{it-1} + \nu_{it}$. Then I will rewrite the approximation of the production function as:
    \begin{equation*}
      \begin{split}
        \ln P_{it}Y_{it} - \rho \ln P_{it-1}Y_{it-1} & = \beta_0^Y(1-\rho) + \beta_G^Y (\ln G_{it} - \rho \ln G_{it-1}) \\
        &  + \beta_B^Y (\ln B_{it} - \rho \ln B_{it-1}) + \beta_L^Y (\ln L_{it} - \rho \ln L_{it-1}) \\
        & + \beta_{GB}^Y [(\ln G_{it} -  \ln B_{it} )^2 - \rho(\ln G_{it-1} - \ln B_{it-1})^2]\\
        & + (z_{it} - \rho z_{it-1}) + (\epsilon_{it} - \rho \epsilon_{it-1})
      \end{split}
    \end{equation*}
    where $(z_{it} - \rho z_{it-1}) + (\epsilon_{it} - \rho \epsilon_{it-1}) = \nu_{it} + (\epsilon_{it} - \rho \epsilon_{it-1})$ is the zero mean error term. Then I can use GMM to estimate the four coefficients with five instruments, namely, $\ln G_{it-1}$, $\ln B_{it-1}$, $\ln L_{it-1}$, $(\ln G_{it-1} - \ln B_{it-1})^2$, and $\ln P_{it-1}Y_{it-1}$.
    \begin{equation*}
        \begin{split}
          \ln P_{it}Y_{it} & = \beta_0^Y(1-\rho) + \beta_G^Y \ln G_{it} - \rho\beta_G^Y \ln G_{it-1} \\
          &  + \beta_B^Y (\ln B_{it} - \rho \ln B_{it-1}) + \beta_L^Y (\ln L_{it} - \rho \ln L_{it-1}) \\
          & + \beta_{GB}^Y [(\ln G_{it} -  \ln B_{it} )^2 - \rho(\ln G_{it-1} - \ln B_{it-1})^2]\\
          & + \rho \ln P_{it-1}Y_{it-1}  + (z_{it} - \rho z_{it-1}) + (\epsilon_{it} - \rho \epsilon_{it-1})
        \end{split}
      \end{equation*}
\end{itemize}

Now given the estimates of the equation above, I can estimate the parameters of the production function.  First two parameters are given by the following ratios:
\begin{gather*}
    \frac{\beta_G}{\beta_B} = \frac{\alpha}{1-\alpha} \rightarrow \alpha \checkmark\\
    \frac{\beta_G}{\beta_L} = \frac{\alpha \beta}{1-\beta} \rightarrow \beta \checkmark
\end{gather*}
Now, I know the the $\alpha$ and $\beta$ parameters. I can use the following ratios to estimate the $\sigma$:
\begin{equation*}
    \begin{split}
        \input{model_elements/marginal benefit L.tex} = \frac{\partial Cost}{\partial L} = (1 + \tau^W_s)w_{si} \\
        \Rightarrow \frac{(1 + \tau^W_s)w_{si} L}{P_{it}Y_{it}} = \frac{W L}{P_{it}Y_{it}}= (1-\beta) \frac{\sigma-1}{\sigma} \rightarrow \sigma \checkmark
    \end{split}
\end{equation*}
Finally, Given the identified parameters, I can estimate the $\gamma$ using the following ratio:
\begin{gather*}
\frac{\beta_{GB}}{\beta_B\beta_G} = \frac{\sigma}{\sigma - 1}\frac{(\gamma-1)}{2\beta} \rightarrow \gamma \checkmark
\end{gather*}

Given the estimated parameters of the production function, I set the production productivity to match the total revenue in the sector. Then I can estimate the emission inefficiency to match the emission intensity of the sector. The estimated parameters are given in the Table~\ref{tab:estimate_parameters}.

\begin{table}[http]
    \centering
    \caption{\quad Parameters to be estimated} \label{tab:estimate_parameters}
    \vspace*{2mm}
    \begin{tabular}{@{}cc@{}}
    \toprule
    \textbf{Parameter}  & \textbf{Source/Moment}\\
    \midrule 
    \multicolumn{2}{c}{Panel A: Estimation} \\
    \midrule
    $\alpha_s$ & ${\beta_G}/{\beta_B}$ \\
    $\beta_s$ & ${\beta_G}/{\beta_L}$\\ 
    $\sigma_s$ & $WL/PY$\\
    $\gamma_s$ & ${\beta_{GB}}/{\beta_B\beta_G}$\\
    $Mean(\log(\hat{A}_{si})) $ & $Mean({L}_{si})$\\
    $Sd(\log({\hat{A}}))$ & $Sd({L}_{si})$\\
    $Mean(\log(\tilde{A}_{si})) $ & $Mean({E/PY})$\\
    $Sd({\log(\tilde{A})})$ & $Sd({E/PY})$\\
    $Corr(\log(\hat{A}),\log(\tilde{A}))$ & $Corr(PY,E/PY)$\\
    \midrule
    \multicolumn{2}{c}{Panel B: Additional Moments} \\
    \midrule
    $ \left(
            \frac{\alpha}{1-\alpha} \frac{r^B + {\tau_E}\tilde{A}}{r^G}
        \right) ^{\frac{1}{\gamma}}$ & $z_k= G/B$ \\\\
    $\frac{1-\beta}{\beta}\frac{1}{\alpha}\left(
        \alpha + (1-\alpha) {{z_k}}^{1-\gamma}
    \right)^{\frac{1}{1-\gamma}} \frac{r^G}{W}$ & $z_l = L/K$ \\\\
    $\frac{1}{\gamma} \frac{\tilde{A}}{r^B + \tau_E\tilde{A}} z_k$ & ${\partial z_k/\partial \tau_E }$ \\\\
    $\frac{\tilde{A}/\gamma}{r^B + \tau_E\tilde{A}}\frac{1}{\frac{\alpha}{1-\alpha}{{z_k}}^{\gamma-1} + 1}{z_l}$ &   $\partial z_l/\partial \tau_E$\\\\
    - & $\Delta(\frac{E}{PY})/\Delta(\frac{C}{PY}) $ \\
    \midrule
    \multicolumn{2}{c}{Panel C: Calibration} \\
    \midrule
    $r$ & $5\%$  \\
    $w$ & $500$ TSEK  \\
    
    \bottomrule
\end{tabular}
\end{table}





% Under either of these assumptions, I can estimate the parameters of the production function and then use the same approach to estimate the emission function\footnote{ The estimation model is:
% \begin{gather*}
%     \ln E_{it} = \beta_0^E + \beta_G^E \ln G_{it} + \beta_B^E \ln B_{it} + \beta_L^E \ln L_{it} + \beta_{GB}^E (\ln G_{it} - \ln B_{it})^2 + \epsilon_{it}
% \end{gather*}}. The estimates of the parameters are given in the Table~\ref{tab:estimate_parameters}.

% \begin{table}[http]
%     \centering
%     \caption{\quad Parameters estimates of production and emission functions} \label{tab:estimate_parameters}
%     \begin{tabular}{cc}
%         \hline
%         \textbf{Parameter} & \textbf{Value} \\
%         \hline
%         $\beta_{s}$ & $1-\beta_L^Y$ \vspace{5pt}
%         \\
%         $\alpha_{s}$ & $1-\dfrac{\beta_B^Y}{1-\beta_L^Y}$ \vspace{5pt}
%         \\
%         $\gamma_{s}$ & $1+\dfrac{2\beta_{GB}^Y(1-\beta_L^Y)}{\beta_G^Y\beta_B^Y}$ \vspace{5pt}
%         \\
%         \hline
%     \end{tabular}
%     \hspace{1cm}
%     \begin{tabular}{cc}
%       \hline
%       \textbf{Parameter} & \textbf{Value} \\
%       \hline
%       $\theta_{s}$ & $1-\beta_L^E$ \vspace{5pt}
%       \\
%       $\mu_{s}$ & $1-\dfrac{\beta_B^E}{1-\beta_L^E}$ \vspace{5pt}
%       \\
%       $\eta_{s}$ & $1+\dfrac{2\beta_{GB}^E(1-\beta_L^E)}{\beta_G^E\beta_B^E}$ \vspace{5pt}
%       \\
%       \hline
%   \end{tabular}
% \end{table}


